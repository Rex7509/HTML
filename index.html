<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>çš®å…‹æ•æ€§æ ¼åœ–é‘‘ï¼šä½ æ˜¯å“ªç¨®å°è·Ÿç­ï¼Ÿ</title>
    <link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">
    <style>
        :root { --primary-color: #4caf50; --text-color: #2d3436; }

        body {
            font-family: 'Varela Round', "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
            margin: 0; padding: 15px; min-height: 100vh;
            display: flex; justify-content: center; align-items: center;
            color: var(--text-color); background-color: #2d3436;
            background-image: url('images/pikmin_background.jpg');
            background-repeat: no-repeat; background-position: center center;
            background-attachment: fixed; background-size: cover; user-select: none;
        }

        body::before { content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.2); pointer-events: none; z-index: -1; }
        .container { background-color: rgba(255, 255, 255, 0.95); backdrop-filter: blur(5px); width: 100%; max-width: 500px; padding: 30px 20px; border-radius: 30px; border: 6px solid #8bc34a; box-shadow: 0 15px 40px rgba(0,0,0,0.3); text-align: center; position: relative; max-height: 95vh; overflow-y: auto; display: flex; flex-direction: column; }
        .container::-webkit-scrollbar { width: 0px; }
        .audio-control { position: absolute; top: 15px; right: 15px; background: #fff; border-radius: 50%; width: 40px; height: 40px; display: flex; justify-content: center; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.2); cursor: pointer; font-size: 1.2rem; z-index: 100; transition: transform 0.2s; border: 2px solid #eee; }
        .audio-control:active { transform: scale(0.9); }

        h1 { font-size: 1.6rem; color: #2e7d32; margin: 10px 0; text-shadow: 2px 2px 0 #fff; }
        p.subtitle { color: #555; margin-bottom: 20px; font-size: 0.95rem; line-height: 1.5; }

        .home-pikmin-squad { display: flex; justify-content: center; align-items: center; gap: 15px; margin: 20px 0; }
        .home-pikmin-squad img {
            width: 75px;
            filter: drop-shadow(0 8px 8px rgba(0,0,0,0.2));
            animation: individual-float 3s infinite ease-in-out;
        }
        .home-pikmin-squad img:nth-child(2) { animation-delay: 0.2s; }
        .home-pikmin-squad img:nth-child(3) { animation-delay: 0.4s; }
        .home-pikmin-squad img:nth-child(4) { animation-delay: 0.6s; }
        .home-pikmin-squad img:nth-child(5) { animation-delay: 0.8s; }
        @keyframes individual-float { 0% { transform: translateY(0); } 50% { transform: translateY(-12px); } 100% { transform: translateY(0); } }

        .btn { border: none; padding: 14px 20px; font-size: 1rem; border-radius: 50px; cursor: pointer; transition: all 0.1s; width: 100%; margin-bottom: 12px; box-shadow: 0 5px 0 rgba(0,0,0,0.2); font-family: 'Varela Round', sans-serif; display: block; box-sizing: border-box; text-decoration: none; position: relative; overflow: hidden; border: 2px solid rgba(255,255,255,0.5); }
        .btn:active { transform: translateY(4px); box-shadow: 0 0 0; }
        .btn-primary { background-color: var(--primary-color); color: white; box-shadow: 0 5px 0 #2e7d32; }
        .btn-info { background-color: #ffca28; color: #5d4037; box-shadow: 0 5px 0 #ff8f00; }
        .btn-secondary { background-color: #90a4ae; color: white; box-shadow: 0 5px 0 #546e7a; }
        
        .option-btn { background-color: #fff; color: var(--text-color); border: 2px solid #e0e0e0; box-shadow: 0 4px 0 #dcdcdc; text-align: left; padding-left: 25px; font-weight: bold; }
        .option-btn:hover { border-color: var(--primary-color); color: var(--primary-color); background-color: #e8f5e9; }
        .progress-container { background-color: #e0e0e0; border-radius: 20px; margin-bottom: 35px; height: 12px; position: relative; }
        .progress-fill { height: 100%; background-color: #8bc34a; width: 0%; transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); border-radius: 20px; position: relative; }
        .progress-fill::after { content: 'ğŸŒ±'; position: absolute; right: -10px; top: -20px; font-size: 1.8rem; filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2)); z-index: 10; }

        .guide-book { background-color: #fffde7; padding: 15px; border-radius: 15px; border: 3px dashed #fbc02d; text-align: left; margin-bottom: 20px; box-shadow: inset 0 0 20px rgba(255, 241, 118, 0.3); }
        .guide-item { border-bottom: 2px dashed rgba(0,0,0,0.1); margin-bottom: 10px; background: rgba(255,255,255,0.5); border-radius: 10px; overflow: hidden; }
        .guide-summary { display: flex; align-items: center; gap: 15px; padding: 12px; cursor: pointer; font-weight: bold; list-style: none; transition: background 0.2s; color: #444; }
        .guide-summary:hover { background: rgba(255,255,255,0.8); }
        .guide-summary::-webkit-details-marker { display: none; }
        .guide-icon { width: 75px; height: 75px; object-fit: contain; }
        .guide-summary:hover .guide-icon { animation-duration: 0.5s; animation-iteration-count: 1; animation-fill-mode: forwards; }
        @keyframes anim-red    { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.3) rotate(-10deg); } } @keyframes anim-yellow { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px) scale(1.2); } } @keyframes anim-blue   { 0%, 100% { transform: rotate(0); } 50% { transform: rotate(15deg) scale(1.2); } 75% {transform: rotate(-15deg) scale(1.2);}} @keyframes anim-purple { 0% {transform: translateY(0);} 40% {transform: translateY(-5px) scale(1.2);} 80% {transform: translateY(2px) scale(0.9);} 100% {transform: translateY(0) scale(1);}} @keyframes anim-white  { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-4px); } 75% { transform: translateX(4px); } } @keyframes anim-rock   { 0%, 100% { transform: rotate(0); } 25% { transform: rotate(-8deg); } 75% { transform: rotate(8deg); } } @keyframes anim-pink   { 0%, 100% { transform: translateY(0) rotate(0); } 50% { transform: translateY(-5px) rotate(5deg) scale(1.2); } } @keyframes anim-ice    { 0%, 100% { transform: scale(1) rotate(0); opacity: 1; } 50% { transform: scale(1.3) rotate(10deg); opacity: 0.8; } } @keyframes anim-glow   { 0%, 100% { filter: brightness(1); } 50% { filter: brightness(2) drop-shadow(0 0 5px #cddc39); transform: scale(1.2); } }
        .guide-summary:hover .icon-red { animation-name: anim-red; } .guide-summary:hover .icon-yellow { animation-name: anim-yellow; } .guide-summary:hover .icon-blue { animation-name: anim-blue; } .guide-summary:hover .icon-purple { animation-name: anim-purple; } .guide-summary:hover .icon-white { animation-name: anim-white; } .guide-summary:hover .icon-rock { animation-name: anim-rock; } .guide-summary:hover .icon-pink { animation-name: anim-pink; } .guide-summary:hover .icon-ice { animation-name: anim-ice; } .guide-summary:hover .icon-glow { animation-name: anim-glow; }
        .guide-content { padding: 0 15px 15px 15px; font-size: 0.9rem; color: #5d4037; animation: slideDown 0.3s ease-out; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        .game-container { position: relative; width: 100%; aspect-ratio: 1 / 1.2; background: #a5d6a7; border-radius: 15px; overflow: hidden; border: 4px solid #388e3c; margin-top: 15px; box-shadow: inset 0 0 20px rgba(0,0,0,0.2); box-sizing: border-box; cursor: none; }
        .hud { position: absolute; top: 8px; left: 10px; right: 10px; display: flex; justify-content: space-between; font-weight: bold; color: white; text-shadow: 1px 1px 2px #000; z-index: 20; pointer-events: none; font-size: 0.9rem; }
        .hud-item { background: rgba(0,0,0,0.3); padding: 3px 8px; border-radius: 20px; }
        .game-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 50; color: white; backdrop-filter: blur(5px); }
        #whistle { position: absolute; border: 2px solid white; border-radius: 50%; width: 45px; height: 45px; transform: translate(-50%, -50%); pointer-events: none; z-index: 100; transition: width 0.1s, height 0.1s, box-shadow 0.1s; }
        #whistle.active { width: 120px; height: 120px; background: rgba(255, 255, 255, 0.2); box-shadow: 0 0 15px cyan, inset 0 0 10px cyan; }
        .wandering-pikmin { position: absolute; width: 60px; height: 60px; will-change: transform; transition: transform 0.2s ease-out; }
        .wandering-pikmin img { width: 100%; height: 100%; object-fit: contain; }
        .wandering-pikmin.collected { animation: collected-anim 0.4s forwards; }
        @keyframes collected-anim { 0% { transform: scale(1) rotate(0); } 50% { transform: scale(1.4) rotate(15deg) translateY(-15px); } 100% { transform: scale(0) rotate(-15deg) translateY(45px); opacity: 0; } }

        .result-avatar {
            width: 220px; height: 220px; 
            background-color: #3a3a3a; 
            border: 6px solid #555; 
            box-shadow: 0 15px 30px rgba(0,0,0,0.25);
            border-radius: 50%; 
            display: flex; justify-content: center; align-items: center;
            position: absolute;
            top: 0;
            left: 50%;
            transform: translate(-50%, -50%); 
            z-index: 2;
        }
        .result-avatar img { width: 90%; height: 90%; object-fit: contain; }
        
        .result-header {
            background: #4a5c33;
            color: white; 
            padding-top: 130px; 
            padding-bottom: 20px;
            border-radius: 20px; 
            margin-top: 110px; 
            position: relative; 
            z-index: 1;
            border: none;
        }
        .result-title { font-size: 2.2rem; font-weight: bold; }
        
        .result-details { background: #fafafa; padding: 20px; border-radius: 15px; margin: 15px 0; text-align: left; }
        .result-details h4 { margin: 0 0 8px 0; font-size: 0.9rem; color: #333; border-left: 4px solid var(--primary-color); padding-left: 10px; }
        .result-details p { margin: 0 0 15px 0; font-size: 0.95rem; line-height: 1.6; color: #555; }
        .result-details p:last-child { margin-bottom: 0; }

        .match-emoji { width: 90px; height: 90px; margin-right: 20px; text-align: center; flex-shrink: 0; }
        .match-emoji img { width: 100%; height: 100%; object-fit: contain; }
        .match-container { display: flex; flex-direction: column; gap: 12px; margin-bottom: 25px; }
        .match-card { display: flex; align-items: center; padding: 12px; border-radius: 15px; text-align: left; border: 1px solid rgba(0,0,0,0.05); background: #fff; }
        .match-card.good { background: #e8f5e9; color: #2e7d32; border-left: 5px solid #4caf50; }
        .match-card.bad { background: #ffebee; color: #c62828; border-left: 5px solid #e53935; }
        .match-info h4 { margin: 0 0 3px 0; font-size: 0.8rem; opacity: 0.8; text-transform: uppercase; }
        .match-info .name { font-weight: bold; font-size: 1.1rem; display: block; }
        .match-info .reason { font-size: 0.85rem; opacity: 0.9; }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <audio id="bgm" loop><source src="BGM.mp3" type="audio/mpeg"></audio>
    <div class="container">
        <div class="audio-control" id="mute-btn" onclick="toggleAudio()">ğŸ”ˆ</div>
        <div id="start-screen">
            <h1 style="font-size: 2rem; margin-bottom: 5px;">çš®å…‹æ•æ€§æ ¼åœ–é‘‘</h1>
            <div style="font-size: 0.9rem; background: #e8f5e9; display: inline-block; padding: 5px 15px; border-radius: 20px; color: #2e7d32; margin-bottom: 20px; border:1px solid #c8e6c9;">å¿ƒç†æ¸¬é©— x å¬é›†éŠæˆ²</div>
            <p class="subtitle">å—¶â€”â€”ï¼å…¨å“¡é›†åˆï¼<br>åœ¨é€™é¡†æœªçŸ¥çš„æ˜Ÿçƒä¸Šï¼Œ<br>ä½ æ˜¯å“ªç¨®ä¸å¯æˆ–ç¼ºçš„å°å¤¥ä¼´ï¼Ÿ</p>
            <div class="home-pikmin-squad">
                <img src="images/red-pikmin.png">
                <img src="images/blue-pikmin.png">
                <img src="images/yellow-pikmin.png">
                <img src="images/purple-pikmin.png">
                <img src="images/white-pikmin.png">
            </div>
            <button class="btn btn-primary" onclick="startQuiz()">ğŸŒ± æ‹”å‡ºè‡ªå·±ï¼(é–‹å§‹æ¸¬é©—)</button>
            <button class="btn btn-info" onclick="showIntro()">ğŸ“– çš®å…‹æ•ç”Ÿæ…‹ & éŠæˆ²</button>
        </div>
        
        <div id="intro-screen" class="hidden">
            <div class="guide-book">
                <h3 style="margin-top:0; color:#f57f17; text-align:center; border-bottom:2px dashed #fbc02d; padding-bottom:10px;">ğŸŒ¿ æ¢éšªå®¶æ—¥èªŒ</h3>
                <p style="font-size:0.8rem; color:#888; text-align:center;">é»æ“Šä¸‹æ–¹åˆ—è¡¨å±•é–‹è©³ç´°è³‡æ–™ â–¼</p>
                <details class="guide-item"><summary class="guide-summary"><img src="images/red-pikmin.png" class="guide-icon icon-red" alt="ç´…è‰²çš®å…‹æ•"> ç´…è‰²çš®å…‹æ•</summary><div class="guide-content"><p><b>æ—¥èªŒ 001ï¼š</b>é€™äº›å°å‚¢ä¼™æ˜¯éšŠä¼çš„å…ˆé‹’ã€‚ä»–å€‘çš„é¬¥å¿—å°±åƒä»–å€‘èº«é«”çš„é¡è‰²ä¸€æ¨£ç«ç†±ã€‚åªè¦æœ‰æˆ°é¬¥ï¼Œæ´¾ä»–å€‘ä¸Šå ´æº–æ²’éŒ¯ã€‚æœ€ç¥å¥‡çš„æ˜¯ï¼Œç«ç„°å°ä»–å€‘å®Œå…¨ç„¡æ•ˆï¼Œæœ‰æ™‚æˆ‘ç”šè‡³è¦ºå¾—ä»–å€‘å¾ˆäº«å—æº«æš–çš„æ„Ÿè¦ºã€‚</p></div></details>
                <details class="guide-item"><summary class="guide-summary"><img src="images/yellow-pikmin.png" class="guide-icon icon-yellow" alt="é»ƒè‰²çš®å…‹æ•"> é»ƒè‰²çš®å…‹æ•</summary><div class="guide-content"><p><b>æ—¥èªŒ 002ï¼š</b>ä»–å€‘çš„å¤§è€³æœµéå¸¸é¡¯çœ¼ï¼Œä¼¼ä¹è®“ä»–å€‘çš„èº«é«”ç‰¹åˆ¥è¼•ç›ˆã€‚æˆ‘èƒ½æŠŠä»–å€‘ä¸Ÿåˆ°å…¶ä»–çš®å…‹æ•ç„¡æ³•ä¼åŠçš„é«˜è™•ã€‚ä»–å€‘å°é›»æœ‰è‘—å¤©ç”Ÿçš„å…ç–«åŠ›ï¼Œè™•ç†é›»è·¯éšœç¤™æ™‚ï¼Œä»–å€‘æ˜¯å”¯ä¸€çš„äººé¸ã€‚æŒ–æ˜å·¥ä½œä¹Ÿç‰¹åˆ¥åœ¨è¡Œã€‚</p></div></details>
                <details class="guide-item"><summary class="guide-summary"><img src="images/blue-pikmin.png" class="guide-icon icon-blue" alt="è—è‰²çš®å…‹æ•"> è—è‰²çš®å…‹æ•</summary><div class="guide-content"><p><b>æ—¥èªŒ 003ï¼š</b>å”¯ä¸€èƒ½è®“æˆ‘å®‰å¿ƒåº¦éæ°´åŸŸçš„å¤¥ä¼´ã€‚ä»–å€‘å˜´é‚Šçš„æ§‹é€ é¡ä¼¼é°“ï¼Œä½¿ä»–å€‘èƒ½åœ¨æ°´ä¸­è‡ªç”±è¡Œå‹•ã€‚åœ¨å…¶ä»–çš®å…‹æ•éƒ½å°æ°´é¿ä¹‹å”¯æä¸åŠæ™‚ï¼Œåªæœ‰ä»–å€‘èƒ½ä¸‹æ°´ä½œæˆ°ã€æ‰“æ’ˆæ²‰åœ¨æ°´åº•çš„å¯¶ç‰©ã€‚</p></div></details>
                <details class="guide-item"><summary class="guide-summary"><img src="images/purple-pikmin.png" class="guide-icon icon-purple" alt="ç´«è‰²çš®å…‹æ•"> ç´«è‰²çš®å…‹æ•</summary><div class="guide-content"><p><b>æ—¥èªŒ 004ï¼š</b>æˆ‘çš„éšŠä¼è£¡çš„é‡é‡ç´šå† è»ã€‚ä¸€å€‹ç´«è‰²çš®å…‹æ•çš„åŠ›æ°£å’Œé‡é‡ï¼Œç›¸ç•¶æ–¼åå€‹æ™®é€šçš®å…‹æ•ã€‚æ¬é‹æ²‰é‡çš„ç‰©å“æ™‚ä¸å¯æˆ–ç¼ºã€‚æŠŠä»–å€‘æŠ•æ“²å‡ºå»æ™‚ç”¢ç”Ÿçš„è¡æ“Šæ³¢ï¼Œç”šè‡³èƒ½éœ‡æšˆå‘¨åœçš„æ•µäººï¼Œéå¸¸å¯é ã€‚</p></div></details>
                <details class="guide-item"><summary class="guide-summary"><img src="images/white-pikmin.png" class="guide-icon icon-white" alt="ç™½è‰²çš®å…‹æ•"> ç™½è‰²çš®å…‹æ•</summary><div class="guide-content"><p><b>æ—¥èªŒ 005ï¼š</b>é«”å‹æœ€å°ï¼Œé€Ÿåº¦å»æœ€å¿«ã€‚ä»–å€‘é‚£é›™ç´…è‰²çš„çœ¼ç›åœ¨é»‘æš—ä¸­æ ¼å¤–é¡¯çœ¼ã€‚ç™½è‰²çš®å…‹æ•æ˜¯å¤©ç”Ÿçš„åµå¯Ÿå…µï¼Œèƒ½è¿…é€Ÿå‹˜æŸ¥åœ°å½¢ï¼Œè€Œä¸”é«”å…§æœ‰æ¯’ã€‚é›–ç„¶é€™è½èµ·ä¾†æœ‰é»å±éšªï¼Œä½†åœ¨å°ä»˜æœƒåé£Ÿçš®å…‹æ•çš„æ•µäººæ™‚ï¼Œé€™é …ç‰¹æ€§å°±æˆäº†è‡´å‘½æ­¦å™¨ã€‚</p></div></details>
                <details class="guide-item"><summary class="guide-summary"><img src="images/rock-pikmin.png" class="guide-icon icon-rock" alt="å²©çŸ³çš®å…‹æ•"> å²©çŸ³çš®å…‹æ•</summary><div class="guide-content"><p><b>æ—¥èªŒ 006ï¼š</b>å …ç¡¬ã€å¯é ã€æœ‰é»å‘†èŒã€‚ä»–å€‘çš„èº«é«”å°±åƒæ‰“ç£¨éçš„å…‰æ»‘å²©çŸ³ï¼Œèƒ½è¼•æ˜“ç ¸ç¢æ°´æ™¶ç‰†ã€‚åŸç”Ÿç”Ÿç‰©æƒ³è¸©æ‰ä»–å€‘æ˜¯çµ•å°ä¸å¯èƒ½çš„ã€‚æŠ•æ“²ä»–å€‘æ™‚é‚£ã€Œå’šã€çš„ä¸€è²ï¼Œè½èµ·ä¾†å°±å¾ˆæœ‰ç ´å£åŠ›ã€‚</p></div></details>
                <details class="guide-item"><summary class="guide-summary"><img src="images/winged-pikmin.png" class="guide-icon icon-pink" alt="ç¾½ç¿…çš®å…‹æ•"> ç¾½ç¿…çš®å…‹æ•</summary><div class="guide-content"><p><b>æ—¥èªŒ 007ï¼š</b>æˆ‘çš„ç©ºä¸­éƒ¨éšŠã€‚ç²‰ç´…è‰²çš„èº«é«”åŠ ä¸Šä¸€å°å°ç¿…è†€ï¼Œè®“ä»–å€‘å¯ä»¥è¼•é¬†é£›è¶Šåœ°é¢ä¸Šçš„éšœç¤™å’Œæ°´å‘ã€‚åœ¨æ¬é‹è·¯ç·šè¤‡é›œæ™‚ï¼Œä»–å€‘ç¸½èƒ½æ‰¾åˆ°æœ€çŸ­çš„ç©ºä¸­ç›´ç·šè·é›¢ï¼Œå¤§å¤§æå‡äº†æ•ˆç‡ã€‚</p></div></details>
                <details class="guide-item"><summary class="guide-summary"><img src="images/ice-pikmin.png" class="guide-icon icon-ice" alt="å†°çš®å…‹æ•"> å†°çš®å…‹æ•</summary><div class="guide-content"><p><b>æ—¥èªŒ 008ï¼š</b>æœ€è¿‘æ‰ç™¼ç¾çš„æ–°å“ç¨®ï¼Œèº«é«”åƒå†°å¡Šä¸€æ¨£æ™¶ç‘©å‰”é€ã€‚ä»–å€‘æ˜¯å¤©ç”Ÿçš„æ§å ´å¤§å¸«ï¼Œä¸åƒ…èƒ½å†°å‡æ°´é¢ï¼Œè®“æˆ‘å€‘å®‰å…¨é€šéï¼Œé‚„èƒ½æŠŠæ•µäººå‡æˆå†°å¡Šï¼Œç‚ºæˆ‘å€‘çˆ­å–å¯¶è²´çš„æ”»æ“Šæ™‚é–“ã€‚çœŸæ˜¯ã€ŒCoolã€çš„å¤¥ä¼´ã€‚</p></div></details>
                <details class="guide-item"><summary class="guide-summary"><img src="images/glow-pikmin.png" class="guide-icon icon-glow" alt="å…‰çš®å…‹æ•"> å…‰çš®å…‹æ•</summary><div class="guide-content"><p><b>æ—¥èªŒ 009ï¼š</b>åªåœ¨å¤œé–“ç¾èº«çš„ç¥ç§˜ç”Ÿç‰©ã€‚ä»–å€‘åƒç¶ è‰²çš„é¬¼ç«ï¼Œå…ç–«æ‰€æœ‰ç’°å¢ƒå‚·å®³ã€‚æœ€é©šäººçš„æ˜¯ï¼Œä»–å€‘èƒ½èšé›†æˆä¸€é¡†å…‰çƒç™¼å‹•è¡æ’æ”»æ“Šï¼Œåœ¨é»‘æš—ä¸­æ˜¯æˆ‘å€‘æœ€å¯é çš„å…‰èŠ’ã€‚</p></div></details>
            </div>
            <button id="game-toggle-btn" class="btn btn-primary" onclick="openGame()">å“¨å­ é›†åˆï¼ (é–‹å§‹éŠæˆ²)</button>
            <div id="game-wrapper" class="hidden">
                <div class="game-container" id="game-area">
                    <div class="hud"><span class="hud-item">TIME: <span id="game-time">45</span></span><span class="hud-item">SCORE: <span id="game-score">0</span></span></div>
                    <div id="pikmin-field"></div>
                    <div id="whistle"></div>
                    <div id="game-start-overlay" class="game-overlay">
                        <div style="font-size: 3rem;">ğŸ˜—</div><h2>çš®å…‹æ•å¤§é›†åˆï¼</h2>
                        <p style="font-size:0.9rem; text-align:center; max-width: 250px;">ç§»å‹•æ»‘é¼ ï¼Œæ‰¾åˆ°åœ°åœ–ä¸Šçš„çš®å…‹æ•ã€‚<br><b>æŒ‰ä½æ»‘é¼ å·¦éµ</b>å¹éŸ¿å“¨å­ä¾†å¬é›†ä»–å€‘ï¼</p>
                        <button class="btn btn-info" style="width:auto;" onclick="startGame()">é–‹å§‹</button>
                        <button class="btn btn-secondary" style="width:auto; margin-top:10px;" onclick="closeGame()">é›¢é–‹</button>
                    </div>
                    <div id="game-end-overlay" class="game-overlay hidden">
                        <div style="font-size: 4rem;">ğŸ†</div><h2>æ™‚é–“åˆ°ï¼</h2><p id="final-score-text">ç¸½å…±å¬é›†äº† 0 éš»</p>
                        <button class="btn btn-info" style="width:auto;" onclick="startGame()">å†ä¾†ä¸€å±€</button>
                        <button class="btn btn-secondary" style="width:auto; margin-top:10px;" onclick="closeGame()">é›¢é–‹</button>
                    </div>
                </div>
            </div>
            <div style="margin-top:20px;"><button class="btn btn-secondary" onclick="goBack()">è¿”å›é¦–é </button></div>
        </div>
        
        <div id="quiz-screen" class="hidden">
            <div class="progress-container"><div class="progress-fill" id="progress"></div></div>
            <h2 id="question-text" style="font-size: 1.3rem; margin-bottom: 30px; color: #333; font-weight: bold;">è¼‰å…¥ä¸­...</h2>
            <div id="options-container"></div>
        </div>
        
        <div id="result-screen" class="result-box hidden">
            <div class="result-header">
                <div class="result-avatar"><img id="result-icon" src="" alt="ä½ çš„æœ¬å‘½çš®å…‹æ•"></div>
                <div style="color:#fff; font-size:1rem;">ä½ çš„æœ¬å‘½çš®å…‹æ•</div>
                <div id="result-title" class="result-title"></div>
            </div>

            <div id="result-details" class="result-details">
            </div>

            <div class="match-container">
                <div class="match-card good"><div class="match-emoji" id="good-match-icon"></div><div class="match-info"><h4>ğŸ’– æœ€ä½³æ‹æª”</h4><span class="name" id="good-match-name"></span><span class="reason" id="good-match-reason"></span></div></div>
                <div class="match-card bad"><div class="match-emoji" id="bad-match-icon"></div><div class="match-info"><h4>âš¡ ç£¨åˆå¤¥ä¼´</h4><span class="name" id="bad-match-name"></span><span class="reason" id="bad-match-reason"></span></div></div>
            </div>
            <button class="btn btn-primary" onclick="location.reload()">å†æ¸¬ä¸€æ¬¡</button>
            <a href="https://www.nintendo.com/jp/character/pikmin/index.html" target="_blank" class="btn btn-secondary" style="background-color:#e60012; color:white; box-shadow: 0 5px 0 #a3000d;">ä»»å¤©å ‚å®˜ç¶² â†—</a>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        const AudioContext = window.AudioContext || window.webkitAudioContext; const ctx = new AudioContext(); let isMuted = true; let whistleSound = null;
        const bgm = document.getElementById('bgm'); bgm.volume = 0.3;
        function toggleAudio() { const btn = document.getElementById('mute-btn'); isMuted = !isMuted; if(isMuted) { btn.innerText = "ğŸ”ˆ"; bgm.pause(); if (whistleSound) whistleSound.stop(); } else { btn.innerText = "ğŸ”Š"; if (ctx.state === 'suspended') ctx.resume(); bgm.play().catch(e => console.log("Blocked")); sfx('click'); } }
        
        function sfx(type, loop = false) {
            if (isMuted) return null;
            if (ctx.state === 'suspended') ctx.resume();
            
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.connect(gain);
            gain.connect(ctx.destination);
            const now = ctx.currentTime;

            if (type === 'click') {
                osc.type = 'sine'; osc.frequency.setValueAtTime(600, now); osc.frequency.exponentialRampToValueAtTime(300, now + 0.1); gain.gain.setValueAtTime(0.1, now); gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1); osc.start(now); osc.stop(now + 0.1);
            } else if (type === 'whistle-short') {
                osc.type = 'sine'; osc.frequency.setValueAtTime(1500, now); osc.frequency.linearRampToValueAtTime(1800, now + 0.05); gain.gain.setValueAtTime(0.06, now); gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1); osc.start(now); osc.stop(now + 0.1);
            } else if (type === 'whistle-loop') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(1600, now);
                gain.gain.setValueAtTime(0.05, now);
                osc.loop = loop;
                osc.start(now);
                return { osc, gain };
            } else if (type === 'cancel' || type === 'gameover') {
                osc.type = 'sawtooth'; osc.frequency.setValueAtTime(400, now); osc.frequency.linearRampToValueAtTime(100, now + 0.2); gain.gain.setValueAtTime(0.1, now); gain.gain.linearRampToValueAtTime(0.01, now + 0.2); osc.start(now); osc.stop(now + 0.2);
            }
            return null;
        }
        
        window.toggleAudio = toggleAudio;
        window.showIntro = () => { document.getElementById('start-screen').classList.add('hidden'); document.getElementById('intro-screen').classList.remove('hidden'); document.querySelector('.container').scrollTop = 0; };
        window.goBack = () => { document.getElementById('intro-screen').classList.add('hidden'); document.getElementById('start-screen').classList.remove('hidden'); stopGame(); };
        window.startQuiz = () => { sfx('click'); document.getElementById('start-screen').classList.add('hidden'); document.getElementById('quiz-screen').classList.remove('hidden'); renderQuestion(); };
        window.openGame = () => { sfx('click'); document.getElementById('game-wrapper').classList.remove('hidden'); document.getElementById('game-toggle-btn').classList.add('hidden'); };
        window.closeGame = () => { sfx('cancel'); stopGame(); document.getElementById('game-wrapper').classList.add('hidden'); document.getElementById('game-toggle-btn').classList.remove('hidden'); };

        let scores = { red: 0, rock: 0, yellow: 0, pink: 0, blue: 0, purple: 0, white: 0, ice: 0, glow: 0 };
        const questions = [ { text: "å‰æ–¹æœ‰ä¸€æ¢å°æ²³æ“‹ä½äº†å»è·¯ï¼Œä½ æœƒï¼Ÿ", options: [{ text: "ç›´æ¥èµ°éå»ï¼Œçœ‹çœ‹æœƒç™¼ç”Ÿä»€éº¼", type: "blue" }, { text: "å°‹æ‰¾æœ€çŸ­çš„è·¯å¾‘ï¼Œç”¨åŠ›é‡è·³éå»ï¼", type: "purple" }, { text: "é£›éå»æ¢è·¯ï¼Œå›å ±çµ¦éšŠå‹", type: "pink" }, { text: "è©¦è‘—æŠŠæ²³é¢çµå‡ï¼Œè£½é€ ä¸€æ¢è·¯", type: "ice" }] }, { text: "ç™¼ç¾ä¸€å€‹å¾æ²’è¦‹éçš„ç¥ç¥•æ´çªŸï¼Œä½ æœƒï¼Ÿ", options: [{ text: "ç¬¬ä¸€å€‹è¡é€²å»ï¼Œçœ‹çœ‹æœ‰ä»€éº¼å¯¶ç‰©", type: "red" }, { text: "åœ¨æ´å£ä»”ç´°è§€å¯Ÿï¼Œåˆ†æå±éšªæ€§", type: "white" }, { text: "ç­‰åˆ°æ™šä¸Šå†é€²å»ï¼Œé»‘æš—ä¸­æˆ‘æœ€å¼·", type: "glow" }, { text: "é€™çœ‹èµ·ä¾†å¾ˆå …å›ºï¼Œæ‡‰è©²å¾ˆå®‰å…¨", type: "rock" }] }, { text: "åœ˜éšŠéœ€è¦æ¬é‹ä¸€å€‹å·¨å¤§çš„é›»æ± ï¼Œä½ æœƒï¼Ÿ", options: [{ text: "æˆ‘åŠ›æ°£æœ€å¤§ï¼Œäº¤çµ¦æˆ‘å§ï¼", type: "purple" }, { text: "æˆ‘ä¾†è¦åŠƒæœ€æœ‰æ•ˆç‡çš„æ¬é‹è·¯ç·š", type: "yellow" }, { text: "æˆ‘é›–ç„¶æ¬ä¸å‹•ï¼Œä½†æˆ‘å¯ä»¥å¹«å¿™æ¸…é™¤è·¯ä¸Šçš„å°éšœç¤™", type: "white" }, { text: "å¤§å®¶ä¸€èµ·åˆä½œï¼Œä¸€å®šæ²’å•é¡Œï¼", type: "blue" }] }, { text: "é‡åˆ°ä¸€éš»çœ‹èµ·ä¾†å¾ˆå…‡çš„åŸç”Ÿç”Ÿç‰©ï¼Œä½ æœƒï¼Ÿ", options: [{ text: "æ­£é¢è¿æ“Šï¼å±•ç¾æˆ‘å€‘çš„å‹‡æ°£ï¼", type: "red" }, { text: "ç”¨èº«é«”æŠŠå®ƒæ’é–‹ï¼Œä¿è­·å¤§å®¶", type: "rock" }, { text: "å…ˆè®“å®ƒå†·éœä¸€ä¸‹ï¼Œæˆ–è¨±ä¸ç”¨æˆ°é¬¥", type: "ice" }, { text: "å¾ç©ºä¸­é€²è¡Œé¨·æ“¾æ”»æ“Š", type: "pink" }] }, { text: "åœ¨å¤œæ™šçš„ç‡Ÿåœ°ï¼Œä½ é€šå¸¸æœƒåšä»€éº¼ï¼Ÿ", options: [{ text: "ç¨è‡ªå·¡é‚ï¼Œå®ˆè­·ç‡Ÿåœ°çš„å®‰å…¨", type: "glow" }, { text: "å’Œå¤§å®¶èšåœ¨ä¸€èµ·ï¼Œåˆ†äº«ä»Šå¤©çš„å†’éšª", type: "yellow" }, { text: "å®‰éœåœ°å¾…åœ¨æ°´é‚Šï¼Œäº«å—ç‰‡åˆ»çš„å¯§éœ", type: "blue" }, { text: "é›éŠèº«é«”ï¼Œç‚ºæ˜å¤©çš„æŒ‘æˆ°åšæº–å‚™", type: "purple" }] } ];
        
        const results = {
            red:    { title: "ç†±è¡€ç´…è‰²çš®å…‹æ•", image: "images/red-pikmin.png",
                      desc: "ä½ æ˜¯åœ˜éšŠçš„ç®­é ­ï¼Œæ“æœ‰ç«ç„°èˆ¬çš„ç†±æƒ…å’Œè¶…ç¾¤çš„æ”»æ“ŠåŠ›ã€‚é‡åˆ°å›°é›£æ™‚ï¼Œå¤§å®¶åªè¦çœ‹åˆ°ä½ è¡åœ¨æœ€å‰é¢ï¼Œå°±æœƒå……æ»¿å‹‡æ°£ã€‚ä½ ç›¸ä¿¡è¡Œå‹•å‹æ–¼ä¸€åˆ‡ï¼Œå–œæ­¡ç”¨æœ€ç›´æ¥çš„æ–¹å¼è§£æ±ºå•é¡Œã€‚",
                      details: { "ğŸ‘ å„ªé»": "è¡Œå‹•åŠ›å¼·ã€å‹‡æ•¢ã€å€¼å¾—ä¿¡è³´ã€ç›®æ¨™å°å‘ã€‚", "ğŸ‘ æ½›åœ¨å¼±é»": "æœ‰æ™‚å¯èƒ½éæ–¼è¡å‹•ï¼Œç¼ºä¹è€å¿ƒï¼Œä¸å¤ªæœƒè€ƒæ…®æ›¿ä»£æ–¹æ¡ˆã€‚", "ğŸ’¡ æ¢éšªå°æç¤º": "åœ¨è¡é‹’å‰ï¼Œè©¦è‘—å…ˆè½è½è—è‰²çš®å…‹æ•çš„å»ºè­°ï¼Œæˆ–è¨±èƒ½è®“ä»»å‹™æ›´é †åˆ©ï¼" },
                      matches: { good: { type: "blue", reason: "ä½ çš„ç†±æƒ…é…ä¸Šä»–çš„å†·éœï¼Œæ˜¯å®Œç¾çš„å¹³è¡¡ã€‚" }, bad: { type: "ice", reason: "ä½ è¦ºå¾—ä»–å¤ªéå†·éœï¼Œæœ‰æ™‚æœƒæ¾†ç†„ä½ çš„é¬¥å¿—ã€‚" } } },
            yellow: { title: "æ¨‚å¤©é»ƒè‰²çš®å…‹æ•", image: "images/yellow-pikmin.png",
                      desc: "ä½ æœ‰è‘—å¤§å¤§çš„è€³æœµï¼Œå–„æ–¼å‚¾è½ä¹Ÿå……æ»¿å¥½å¥‡å¿ƒã€‚ä½ ä¸æ€•è§¸é›»èˆ¬çš„å›°é›£ï¼Œç¸½èƒ½è·³å¾—å¾ˆé«˜ï¼Œå¸¶é ˜å¤§å®¶çœ‹åˆ°äº‹æƒ…æ¨‚è§€çš„ä¸€é¢ã€‚ä½ æ˜¯åœ˜éšŠä¸­çš„æ°£æ°›è£½é€ è€…ï¼Œæœ‰ä½ åœ¨å°±ä¸æœƒç„¡èŠã€‚",
                      details: { "ğŸ‘ å„ªé»": "æ¨‚è§€ã€æœ‰å‰µæ„ã€å–„æ–¼æºé€šã€é©æ‡‰åŠ›å¼·ã€‚", "ğŸ‘ æ½›åœ¨å¼±é»": "æœ‰æ™‚å¯èƒ½ä¸å¤ å°ˆæ³¨ï¼Œå®¹æ˜“è¢«æ–°å¥‡çš„äº‹ç‰©å¸å¼•è€Œåˆ†å¿ƒã€‚", "ğŸ’¡ æ¢éšªå°æç¤º": "ä½ çš„è·³èºèƒ½åŠ›è®“ä½ ç¸½èƒ½çœ‹åˆ°åˆ¥äººçœ‹ä¸åˆ°çš„æ©Ÿæœƒï¼Œå¤§è†½åˆ†äº«ä½ çš„ç™¼ç¾å§ï¼" },
                      matches: { good: { type: "pink", reason: "ä½ å€‘éƒ½æ˜¯æ¨‚å¤©æ´¾ï¼Œåœ¨ä¸€èµ·ç¸½æœ‰èŠä¸å®Œçš„è©±é¡Œã€‚" }, bad: { type: "purple", reason: "ä»–å¤ªæ²‰é»˜å¯¡è¨€äº†ï¼Œè®“ä½ è¦ºå¾—æ°£æ°›æœ‰é»æ²‰æ‚¶ã€‚" } } },
            blue:   { title: "æ²‰ç©©è—è‰²çš®å…‹æ•", image: "images/blue-pikmin.png",
                      desc: "ä½ åƒæ°´ä¸€æ¨£æ²‰è‘—å†·éœï¼Œæ˜¯åœ˜éšŠä¸­å®‰å®šçš„åŠ›é‡ã€‚ç„¡è«–é‡åˆ°å¤šå¤§çš„é¢¨æµªï¼Œä½ éƒ½èƒ½ä¿æŒå¹³å¸¸å¿ƒï¼Œå¸¶é ˜å¤§å®¶å®‰ç„¶åº¦éã€‚ä½ æ·±æ€ç†Ÿæ…®ï¼Œæ˜¯åœ˜éšŠä¸­æœ€å¯é çš„åƒè¬€ã€‚",
                      details: { "ğŸ‘ å„ªé»": "å†·éœã€æœ‰è€å¿ƒã€æ€è€ƒå‘¨å…¨ã€å€¼å¾—ä¾é ã€‚", "ğŸ‘ æ½›åœ¨å¼±é»": "æœ‰æ™‚å¯èƒ½éæ–¼è¬¹æ…è€ŒéŒ¯å¤±è‰¯æ©Ÿï¼Œè¡Œå‹•å‰éœ€è¦è¼ƒå¤šçš„æº–å‚™æ™‚é–“ã€‚", "ğŸ’¡ æ¢éšªå°æç¤º": "ç•¶åœ˜éšŠé™·å…¥æ··äº‚æ™‚ï¼Œä½ çš„å†·éœåˆ¤æ–·æ˜¯å¼•å°å¤§å®¶å‰é€²çš„é—œéµåŠ›é‡ã€‚" },
                      matches: { good: { type: "red", reason: "ä»–èƒ½é»ç‡ƒä½ çš„è¡Œå‹•åŠ›ï¼Œè€Œä½ èƒ½è®“ä»–ä¿æŒå†·éœã€‚" }, bad: { type: "white", reason: "ä½ è¦ºå¾—ä»–è·‘å¾—å¤ªå¿«ï¼Œè®“ä½ æœ‰é»è·Ÿä¸ä¸Šç¯€å¥ã€‚" } } },
            purple: { title: "å¯é ç´«è‰²çš®å…‹æ•", image: "images/purple-pikmin.png",
                      desc: "ä½ æ˜¯åœ˜éšŠä¸­æœ€å¼·å£¯çš„å¾Œç›¾ï¼Œæ“æœ‰åå€çš„åŠ›é‡èˆ‡é‡é‡ã€‚é›–ç„¶ä¸å–„è¨€è¾­ï¼Œä½†ä½ ç¸½æ˜¯ç”¨è¡Œå‹•è­‰æ˜è‡ªå·±æ˜¯å¤§å®¶æœ€å¯é çš„å¤¥ä¼´ã€‚ä½ é»˜é»˜åœ°æ‰›èµ·äº†æœ€å¤šçš„é‡æ“”ã€‚",
                      details: { "ğŸ‘ å„ªé»": "å¼·å¤§ã€å¯é ã€æœ‰æ¯…åŠ›ã€è…³è¸å¯¦åœ°ã€‚", "ğŸ‘ æ½›åœ¨å¼±é»": "ä¸å–„æ–¼è¡¨é”è‡ªå·±ï¼Œæœ‰æ™‚æœƒçµ¦äººä¸€ç¨®ç¬¨æ‹™æˆ–é²éˆçš„å°è±¡ã€‚", "ğŸ’¡ æ¢éšªå°æç¤º": "ä½ çš„åŠ›é‡ä¸åƒ…èƒ½æ¬é‹é‡ç‰©ï¼Œåœ¨é—œéµæ™‚åˆ»ä¹Ÿèƒ½æˆç‚ºæ“Šæšˆæ•µäººçš„ç‹ç‰Œï¼" },
                      matches: { good: { type: "white", reason: "ä»–çš„æ•æ·åµæŸ¥ï¼Œé…ä¸Šä½ çš„å£“å€’æ€§åŠ›é‡ï¼Œç„¡äººèƒ½æ•µã€‚" }, bad: { type: "yellow", reason: "ä»–å¤ªæ´»æ½‘äº†ï¼Œæœ‰æ™‚å€™è®“ä½ è¦ºå¾—æœ‰é»åµé¬§ã€‚" } } },
            white:  { title: "æ•éŠ³ç™½è‰²çš®å…‹æ•", image: "images/white-pikmin.png",
                      desc: "ä½ èº«æ‰‹çŸ¯å¥ï¼Œé€Ÿåº¦é£›å¿«ï¼Œæ˜¯åœ˜éšŠè£¡çš„åµæŸ¥å°ˆå®¶ã€‚ä½ æœ‰è‘—æ•éŠ³çš„æ´å¯ŸåŠ›ï¼Œèƒ½ç™¼ç¾åˆ¥äººçœ‹ä¸åˆ°çš„ç´°ç¯€å’Œåœ°ä¸‹çš„å¯¶ç‰©ã€‚ä½ ç¸½æ˜¯ç¬¬ä¸€å€‹ç™¼ç¾å±éšªæˆ–æ©Ÿæœƒçš„äººã€‚",
                      details: { "ğŸ‘ å„ªé»": "åæ‡‰å¿«ã€æ´å¯ŸåŠ›æ•éŠ³ã€æ•ˆç‡é«˜ã€ç›´è¦ºæº–ç¢ºã€‚", "ğŸ‘ æ½›åœ¨å¼±é»": "å¯èƒ½ç¼ºä¹è€å¿ƒï¼Œå°æ–¼æ…¢ç¯€å¥çš„å¤¥ä¼´æœƒæ„Ÿåˆ°ä¸è€ç…©ã€‚", "ğŸ’¡ æ¢éšªå°æç¤º": "ä½ çš„é€Ÿåº¦æ˜¯åœ˜éšŠçš„é›™é¢åˆƒï¼Œæ—¢èƒ½å¿«é€Ÿæ¢è·¯ï¼Œä¹Ÿè¦å°å¿ƒä¸è¦è¡å¤ªå¿«è€Œè½å–®ï¼" },
                      matches: { good: { type: "purple", reason: "ä½ çš„é€Ÿåº¦é…ä¸Šä»–çš„åŠ›é‡ï¼Œæ˜¯å®Œç¾çš„çªæ“Šçµ„åˆã€‚" }, bad: { type: "blue", reason: "ä»–ç¸½æ˜¯æ…¢æ‚ æ‚ çš„ï¼Œè®“ä½ è¦ºå¾—æœ‰é»å¿ƒæ€¥ã€‚" } } },
            rock:   { title: "å …æ¯…å²©çŸ³çš®å…‹æ•", image: "images/rock-pikmin.png",
                      desc: "å¤–è¡¨å‰›ç¡¬ï¼Œå…§å¿ƒå–®ç´”ã€‚ä½ ä¸å–œæ­¡èŠ±è¨€å·§èªï¼Œç¸½æ˜¯ç”¨æœ€å¯¦éš›çš„è¡Œå‹•ï¼ˆå’Œå …ç¡¬çš„èº«é«”ï¼‰ä¾†ç‚ºåœ˜éšŠé–‹è·¯ã€å®ˆè­·å¤§å®¶ã€‚ä½ æ˜¯åœ˜éšŠä¸­æœ€å …å›ºçš„é˜²ç·šã€‚",
                      details: { "ğŸ‘ å„ªé»": "å …å®šã€æœ‰åŸå‰‡ã€ä¿è­·æ¬²å¼·ã€éå¸¸å¯é ã€‚", "ğŸ‘ æ½›åœ¨å¼±é»": "æœ‰æ™‚å¯èƒ½éæ–¼å›ºåŸ·ï¼Œä¸æ‡‚è®Šé€šï¼Œé›£ä»¥æ¥å—æ–°æƒ³æ³•ã€‚", "ğŸ’¡ æ¢éšªå°æç¤º": "ä½ çš„å …ç¡¬ä¸åªèƒ½ç”¨ä¾†é˜²ç¦¦ï¼Œæ›´æ˜¯ç ¸é–‹æ°´æ™¶ã€é–‹é—¢æ–°é“è·¯çš„é—œéµï¼" },
                      matches: { good: { type: "red", reason: "ä½ éœ€è¦ä¸€å€‹èƒ½å¸¶é ˜æ–¹å‘çš„äººï¼Œè€Œä»–éœ€è¦ä¸€å€‹å …å¯¦çš„é å±±ã€‚" }, bad: { type: "glow", reason: "ä½ ç¿’æ…£åœ¨é™½å…‰ä¸‹è¡Œå‹•ï¼Œä¸å¤ªé©æ‡‰ä»–çš„æ™ä¼å¤œå‡ºã€‚" } } },
            pink:   { title: "è‡ªç”±ç¾½ç¿…çš®å…‹æ•", image: "images/winged-pikmin.png",
                      desc: "ä½ è¨å­èµ°å°‹å¸¸è·¯ï¼Œå–œæ­¡é£›åœ¨ç©ºä¸­æ‰¾æ·å¾‘ã€‚é›–ç„¶æœ‰æ™‚ç¨å¾®ç‹€æ³å¤–ï¼Œä½†ä½ çš„å‰µæ„å’Œç¨ç‰¹è¦–è§’ç¸½èƒ½ç‚ºåœ˜éšŠå¸¶ä¾†å¥‡è¹Ÿï¼Œæ‰¾åˆ°æ„æƒ³ä¸åˆ°çš„è§£æ±ºæ–¹æ¡ˆã€‚",
                      details: { "ğŸ‘ å„ªé»": "æœ‰é è¦‹ã€æ€ç¶­éˆæ´»ã€æ“…é•·å¤šå·¥è™•ç†ã€ä¸æ‹˜ä¸€æ ¼ã€‚", "ğŸ‘ æ½›åœ¨å¼±é»": "æœ‰æ™‚å¯èƒ½ä¸å¤ å‹™å¯¦ï¼Œæƒ³æ³•å¤©é¦¬è¡Œç©ºä½†é›£ä»¥åŸ·è¡Œã€‚", "ğŸ’¡ æ¢éšªå°æç¤º": "å¾é«˜è™•ä¿¯ç°å…¨å±€æ˜¯ä½ çš„å¤©è³¦ï¼Œè¨˜å¾—å°‡ä½ çœ‹åˆ°çš„ç‰¹æ®Šè·¯ç·šåˆ†äº«çµ¦å¤¥ä¼´ï¼" },
                      matches: { good: { type: "yellow", reason: "ä»–èƒ½ç†è§£ä½ å¤©é¦¬è¡Œç©ºçš„é»å­ï¼Œä¸¦ç‚ºä½ å–é‡‡ã€‚" }, bad: { type: "rock", reason: "ä½ å–œæ­¡è‡ªç”±é£›è¡Œï¼Œä»–å»ç¸½åœ¨åœ°ä¸Šè®“ä½ è¦ºå¾—å—é™ã€‚" } } },
            ice:    { title: "å†·éœå†°çš®å…‹æ•", image: "images/ice-pikmin.png",
                      desc: "ä½ é ­è…¦æ¸…æ™°ï¼Œé‡äº‹å†·éœï¼Œæ˜¯åœ˜éšŠçš„ç­–ç•¥å®¶ã€‚ä½ èƒ½å‡çµå¨è„…ã€é‹ªå¹³æ°´è·¯ï¼Œåœ¨æ··äº‚ä¸­ä¿æŒåˆ†æèƒ½åŠ›ï¼Œç¸½èƒ½åœ¨é—œéµæ™‚åˆ»åšå‡ºæœ€ã€ŒCoolã€çš„åˆ¤æ–·ã€‚",
                      details: { "ğŸ‘ å„ªé»": "åˆ†æèƒ½åŠ›å¼·ã€æ²‰è‘—ã€æœ‰æ¢ç†ã€å–„æ–¼è§£æ±ºå•é¡Œã€‚", "ğŸ‘ æ½›åœ¨å¼±é»": "å¯èƒ½å¸¶çµ¦äººä¸€ç¨®å†·æ¼ æˆ–ç–é›¢çš„æ„Ÿè¦ºï¼Œæƒ…æ„Ÿè¡¨é”è¼ƒç‚ºå…§æ–‚ã€‚", "ğŸ’¡ æ¢éšªå°æç¤º": "ä½ çš„å†°å‡èƒ½åŠ›æ˜¯åœ˜éšŠæœ€å¼·çš„æ§å ´æŠ€ï¼Œå–„ç”¨å®ƒä¾†æ”¹è®Šæˆ°å±€å§ï¼" },
                      matches: { good: { type: "glow", reason: "ä½ å€‘éƒ½å–œæ­¡åœ¨å®‰éœçš„ç’°å¢ƒæ€è€ƒï¼Œå¾ˆæœ‰é»˜å¥‘ã€‚" }, bad: { type: "red", reason: "ä»–çš„é­¯è½è¡Œäº‹ï¼Œæ™‚å¸¸æ‰“äº‚ä½ æ·±æ€ç†Ÿæ…®çš„è¨ˆç•«ã€‚" } } },
            glow:   { title: "ç¥ç§˜å…‰çš®å…‹æ•", image: "images/glow-pikmin.png",
                      desc: "ä½ æ˜¯é»‘å¤œä¸­çš„ä¸€é“å…‰ï¼Œç¥ç§˜è€Œå¼·å¤§ã€‚ä½ ç¿’æ…£åœ¨å®‰éœçš„ç’°å¢ƒä¸­ç¨ç«‹æ€è€ƒï¼Œé›–ç„¶æœ‰é»ç¨ä¾†ç¨å¾€ï¼Œå»æ˜¯å¤§å®¶åœ¨é»‘æš—æˆ–è¿·èŒ«ä¸­å¯ä»¥ä¾é çš„æŒ‡å¼•ã€‚",
                      details: { "ğŸ‘ å„ªé»": "ç¨ç«‹ã€ç›´è¦ºæ•éŠ³ã€å…§å¿ƒå¼·å¤§ã€ä¸å—å¤–ç•Œå¹²æ“¾ã€‚", "ğŸ‘ æ½›åœ¨å¼±é»": "ä¸å–œæ­¡éå¤šçš„ç¤¾äº¤ï¼Œæœ‰æ™‚æœƒé¡¯å¾—å­¤åƒ»ï¼Œé›£ä»¥èå…¥åœ˜éšŠã€‚", "ğŸ’¡ æ¢éšªå°æç¤º": "ä½ ç„¡æ‡¼ä»»ä½•å±¬æ€§çš„ç‰¹è³ªè®“ä½ æˆç‚ºè¬èƒ½é‘°åŒ™ï¼Œåœ¨æœ€è‰±å›°çš„ç’°å¢ƒä¸­ä½ å°±æ˜¯å¸Œæœ›ï¼" },
                      matches: { good: { type: "ice", reason: "ä½ å€‘éƒ½äº«å—å­¤ç¨ï¼Œèƒ½ç†è§£å°æ–¹éœ€è¦å€‹äººç©ºé–“ã€‚" }, bad: { type: "rock", reason: "ä½ å–œæ­¡è¼•ç›ˆåœ°ç©¿æ¢­ï¼Œè€Œä»–å …å¯¦çš„æ­¥ä¼è®“ä½ æ„Ÿåˆ°ç¬¨é‡ã€‚" } } }
        };
        let currentQuestionIndex = 0;
        function renderQuestion() {
            const questionTextElement = document.getElementById('question-text');
            const optionsDivElement = document.getElementById('options-container');
            const progressElement = document.getElementById('progress');
            if (!questionTextElement || !optionsDivElement || !progressElement) { return; }
            if (currentQuestionIndex >= questions.length) { progressElement.style.width = `100%`; setTimeout(showResult, 400); return; } 
            const question = questions[currentQuestionIndex]; 
            questionTextElement.innerText = question.text; 
            optionsDivElement.innerHTML = ''; 
            const progress = 10 + ((currentQuestionIndex) / questions.length) * 90; 
            progressElement.style.width = `${progress}%`; 
            const shuffledOptions = [...question.options].sort(() => Math.random() - 0.5); 
            shuffledOptions.forEach(option => { 
                const btn = document.createElement('button'); 
                btn.className = 'btn option-btn'; btn.innerText = option.text; 
                btn.onclick = () => { sfx('click'); scores[option.type]++; currentQuestionIndex++; renderQuestion(); }; 
                optionsDivElement.appendChild(btn); 
            }); 
        }
        
        function showResult() {
            document.getElementById('quiz-screen').classList.add('hidden'); document.getElementById('result-screen').classList.remove('hidden'); sfx('whistle-short');
            const winnerType = Object.keys(scores).reduce((a, b) => scores[a] >= scores[b] ? a : b);
            const data = results[winnerType];
            const goodMatch = results[data.matches.good.type];
            const badMatch = results[data.matches.bad.type];
            document.getElementById('result-icon').src = data.image;
            document.getElementById('result-title').innerText = data.title;
            const detailsContainer = document.getElementById('result-details');
            detailsContainer.innerHTML = `<h4>æ€§æ ¼å´å¯«</h4><p>${data.desc}</p><h4>ğŸ‘ å„ªé»</h4><p>${data.details["ğŸ‘ å„ªé»"]}</p><h4>ğŸ‘ æ½›åœ¨å¼±é»</h4><p>${data.details["ğŸ‘ æ½›åœ¨å¼±é»"]}</p><h4>ğŸ’¡ æ¢éšªå°æç¤º</h4><p>${data.details["ğŸ’¡ æ¢éšªå°æç¤º"]}</p>`;
            document.getElementById('good-match-icon').innerHTML = `<img src="${goodMatch.image}" alt="${goodMatch.title}">`;
            document.getElementById('good-match-name').innerText = goodMatch.title.replace("çš®å…‹æ•", "");
            document.getElementById('good-match-reason').innerText = data.matches.good.reason;
            document.getElementById('bad-match-icon').innerHTML = `<img src="${badMatch.image}" alt="${badMatch.title}">`;
            document.getElementById('bad-match-name').innerText = badMatch.title.replace("çš®å…‹æ•", "");
            document.getElementById('bad-match-reason').innerText = data.matches.bad.reason;
        }

        let gameScore = 0, gameTime = 45, isPlaying = false, gameTimer, gameLoopInterval;
        let whistle, gameArea, pikminField;
        const pikminImagePaths = [ "images/red-pikmin.png", "images/yellow-pikmin.png", "images/blue-pikmin.png", "images/rock-pikmin.png", "images/ice-pikmin.png", "images/winged-pikmin.png", "images/white-pikmin.png", "images/purple-pikmin.png", "images/glow-pikmin.png" ];

        window.startGame = function() {
            sfx('click'); gameScore = 0; gameTime = 45; isPlaying = true;
            whistle = document.getElementById('whistle');
            gameArea = document.getElementById('game-area');
            pikminField = document.getElementById('pikmin-field');
            pikminField.innerHTML = '';
            document.getElementById('game-score').innerText = gameScore;
            document.getElementById('game-time').innerText = gameTime;
            document.getElementById('game-start-overlay').classList.add('hidden');
            document.getElementById('game-end-overlay').classList.add('hidden');
            gameArea.addEventListener('mousemove', moveWhistle);
            gameArea.addEventListener('mousedown', activateWhistle);
            gameArea.addEventListener('mouseup', deactivateWhistle);
            gameArea.addEventListener('mouseleave', deactivateWhistle);
            gameTimer = setInterval(() => { gameTime--; document.getElementById('game-time').innerText = gameTime; if (gameTime <= 0) endGame(); }, 1000);
            gameLoopInterval = setInterval(gameLoopLogic, 100);
            spawnPikmin();
        }
        window.stopGame = function() {
            isPlaying = false;
            clearInterval(gameTimer);
            clearInterval(gameLoopInterval);
            if (gameArea) {
                gameArea.removeEventListener('mousemove', moveWhistle);
                gameArea.removeEventListener('mousedown', activateWhistle);
                gameArea.removeEventListener('mouseup', deactivateWhistle);
                gameArea.removeEventListener('mouseleave', deactivateWhistle);
            }
            deactivateWhistle();
        }
        function moveWhistle(e) { const rect = gameArea.getBoundingClientRect(); whistle.style.left = `${e.clientX - rect.left}px`; whistle.style.top = `${e.clientY - rect.top}px`; }
        
        function activateWhistle() { 
            if(isPlaying) {
                whistle.classList.add('active');
                if (!whistleSound) {
                    const sound = sfx('whistle-loop', true);
                    if (sound) whistleSound = sound.osc;
                }
            }
        }
        function deactivateWhistle() { 
            if(isPlaying) {
                whistle.classList.remove('active');
                if (whistleSound) { whistleSound.stop(); whistleSound = null; }
            }
        }

        function spawnPikmin() {
            if (!isPlaying || pikminField.children.length > 15) return;
            const pik = document.createElement('div'); pik.className = 'wandering-pikmin';
            const img = document.createElement('img'); img.src = pikminImagePaths[Math.floor(Math.random() * pikminImagePaths.length)];
            pik.appendChild(img);
            pik.style.left = `${Math.random() * (gameArea.offsetWidth - 40)}px`;
            pik.style.top = `${Math.random() * (gameArea.offsetHeight - 40)}px`;
            pikminField.appendChild(pik);
        }
        function gameLoopLogic() {
            if (!isPlaying) return;
            if (Math.random() < 0.5) spawnPikmin();
            const whistleRect = whistle.getBoundingClientRect();
            const isWhistleActive = whistle.classList.contains('active');
            for (let pik of pikminField.children) {
                if (pik.classList.contains('collected')) continue;
                if (Math.random() < 0.1) {
                    const dx = (Math.random() - 0.5) * 30; const dy = (Math.random() - 0.5) * 30;
                    const newX = Math.max(0, Math.min(gameArea.offsetWidth - 40, pik.offsetLeft + dx));
                    const newY = Math.max(0, Math.min(gameArea.offsetHeight - 40, pik.offsetTop + dy));
                    pik.style.transform = `translate(${newX - pik.offsetLeft}px, ${newY - pik.offsetTop}px)`;
                }
                if (isWhistleActive) {
                    const pikRect = pik.getBoundingClientRect();
                    if (whistleRect.left < pikRect.right && whistleRect.right > pikRect.left &&
                        whistleRect.top < pikRect.bottom && whistleRect.bottom > pikRect.top) {
                        collectPikmin(pik);
                    }
                }
            }
        }
        function collectPikmin(pik) {
            pik.classList.add('collected'); sfx('whistle-short'); gameScore++;
            document.getElementById('game-score').innerText = gameScore;
            setTimeout(() => pik.remove(), 400);
        }
        function endGame() {
            stopGame(); sfx('gameover');
            document.getElementById('game-end-overlay').classList.remove('hidden');
            document.getElementById('final-score-text').innerText = `ç¸½å…±å¬é›†äº† ${gameScore} éš»`;
        }

    });
    </script>
</body>
</html>